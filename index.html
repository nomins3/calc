<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Fork Control Center</title>
    <style>
        :root { --bg: #000; --card: #1a1a1a; --primary: #3498db; --win: #2ecc71; --loss: #e74c3c; }
        body { font-family: system-ui, sans-serif; background: var(--bg); color: #fff; margin: 0; padding: 0; overscroll-behavior: none; }
        
        /* Липкая панель результатов */
        .sticky-results { 
            position: sticky; top: 0; z-index: 100;
            background: #111; padding: 10px; border-bottom: 2px solid #333;
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; text-align: center;
        }
        .res-box span { display: block; font-size: 10px; color: #888; text-transform: uppercase; }
        .res-box b { font-size: 18px; }

        .wrapper { padding: 10px; max-width: 500px; margin: 0 auto; }
        
        .bank-row { display: flex; justify-content: space-between; align-items: center; margin: 10px 0; padding: 0 5px; }
        .bank-row input { background: #000; color: var(--win); border: 1px solid #444; font-size: 18px; width: 90px; padding: 5px; border-radius: 6px; text-align: center; }

        /* Переключатель плечей */
        .tabs { display: flex; gap: 10px; margin-bottom: 10px; }
        .tab { flex: 1; padding: 12px; background: #333; border-radius: 10px; text-align: center; font-weight: bold; cursor: pointer; }
        .tab.active { background: var(--primary); }

        .arm-box { 
            background: var(--card); padding: 15px; border-radius: 16px; 
            border: 2px solid #333; display: none; 
        }
        .arm-box.active { display: block; }
        
        /* Цветовые статусы */
        .status-win { border-color: var(--win) !important; }
        .status-loss { border-color: var(--loss) !important; }
        .text-win { color: var(--win) !important; }
        .text-loss { color: var(--loss) !important; }

        .display-k { font-size: 45px; text-align: center; color: var(--primary); margin-bottom: 15px; font-family: monospace; }

        .btn-label { font-size: 11px; color: #666; margin: 8px 0 4px 5px; text-transform: uppercase; }
        .btn-row { display: grid; grid-template-columns: repeat(5, 1fr); gap: 6px; margin-bottom: 10px; }
        
        button { border: none; padding: 14px 0; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 16px; color: #fff; background: #2c3e50; }
        button:active { transform: scale(0.9); }
        .btn-cent { background: #444; font-size: 13px; }
        button.active { background: var(--primary) !important; box-shadow: 0 0 10px rgba(52,152,219,0.5); }
    </style>
</head>
<body>

<div class="sticky-results" id="sticky">
    <div class="res-box"><span>Ставка 1</span><b id="s1">0</b></div>
    <div class="res-box"><span>Ставка 2</span><b id="s2">0</b></div>
    <div class="res-box"><span>Прибыль</span><b id="profit">0.00</b></div>
</div>

<div class="wrapper">
    <div class="bank-row">
        <span>БАНК: <input type="number" id="bank" value="1000" oninput="calc()"></span>
        <span>ROI: <b id="roi">0.00%</b></span>
    </div>

    <div class="tabs">
        <div class="tab active" id="tab1" onclick="switchArm(1)">ПЛЕЧО 1</div>
        <div class="tab" id="tab2" onclick="switchArm(2)">ПЛЕЧО 2</div>
    </div>

    <div class="arm-box active" id="box1">
        <div class="display-k" id="out1">1.00</div>
        <div id="controls1"></div>
    </div>

    <div class="arm-box" id="box2">
        <div class="display-k" id="out2">1.00</div>
        <div id="controls2"></div>
    </div>
</div>

<script>
    let state = { k1: [1, 0, 0], k2: [1, 0, 0] };

    function switchArm(n) {
        document.querySelectorAll('.tab, .arm-box').forEach(el => el.classList.remove('active'));
        document.getElementById('tab' + n).classList.add('active');
        document.getElementById('box' + n).classList.add('active');
    }

    function createButtons(armNum) {
        const rows = [
            { label: 'Целые', type: 0, vals: [1,2,3,4,5,6,7,8,9,10], class: '' },
            { label: 'Десятые', type: 1, vals: [0,.1,.2,.3,.4,.5,.6,.7,.8,.9], class: '' },
            { label: 'Сотые', type: 2, vals: [0,.01,.02,.03,.04,.05,.06,.07,.08,.09], class: 'btn-cent' }
        ];

        const container = document.getElementById('controls' + armNum);
        rows.forEach(row => {
            const lbl = document.createElement('div'); lbl.className = 'btn-label'; lbl.textContent = row.label;
            container.appendChild(lbl);
            const grid = document.createElement('div'); grid.className = 'btn-row';
            row.vals.forEach(v => {
                const btn = document.createElement('button');
                btn.className = row.class;
                btn.textContent = v === 0 ? "0" : v.toString().replace("0.", ".");
                btn.onclick = () => {
                    grid.querySelectorAll('button').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    state['k' + armNum][row.type] = v;
                    updateK(armNum);
                };
                if(v === (row.type === 0 ? 1 : 0)) btn.classList.add('active');
                grid.appendChild(btn);
            });
            container.appendChild(grid);
        });
    }

    function updateK(n) {
        let val = state['k' + n][0] + state['k' + n][1] + state['k' + n][2];
        document.getElementById('out' + n).textContent = val.toFixed(2);
        calc();
    }

    function calc() {
        let B = parseFloat(bank.value) || 0;
        let k1 = state.k1[0] + state.k1[1] + state.k1[2];
        let k2 = state.k2[0] + state.k2[1] + state.k2[2];
        
        let s1v = B * (k2 / (k1 + k2));
        let s2v = B * (k1 / (k1 + k2));
        let p = (s1v * k1) - B;
        let r = (p / B) * 100;

        s1.textContent = Math.round(s1v);
        s2.textContent = Math.round(s2v);
        profit.textContent = p.toFixed(2);
        roi.textContent = r.toFixed(2) + '%';

        // Логика цвета
        const boxes = document.querySelectorAll('.arm-box');
        const profitText = document.getElementById('profit');
        const roiText = document.getElementById('roi');

        if (p > 0) {
            boxes.forEach(b => { b.classList.add('status-win'); b.classList.remove('status-loss'); });
            profitText.className = roiText.className = 'text-win';
        } else {
            boxes.forEach(b => { b.classList.remove('status-win'); b.classList.add('status-loss'); });
            profitText.className = roiText.className = 'text-loss';
        }
    }

    createButtons(1); createButtons(2); calc();
</script>
</body>
</html>
